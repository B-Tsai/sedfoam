/**
 * \file        governingEq.doc
 * \author      Cyrille Bonamy and Julien Chauchat
 * \date        June 06, 2021
 * \brief       SedFOAM governing equations
 */
/*! \page governing Governing equations 

The mathematical formulation of the Eulerian two-phase flow model sedFoam is obtained by averaging local and instantaneous mass and momentum conservation equations over fluid and dispersed particles. Different averaging operators can be used, ensemble averaging (Drew, 1983) or spatial averaging (Jackson, 2000), and provided that the mathematical derivation is done properly, the different approaches should lead to the same conservation equations (Zhang and Prosperetti, 1997; Jackson, 1997). The resulting governing equations can be considered as the counterpart of the clear fluid Navier-Stokes equations for single phase flow. In order to apply these equations to turbulent flow, in which turbulent motions are generated by flow shear much larger than the grain scale, additional turbulence averaging or filtering is required. In the present model, turbulence-averaged Eulerian two-phase flow equations are derived by following a similar procedure presented in Hsu et al. (2003); Hsu and Liu (2004).

\section turbAvg Turbulence-averaged two-phase flow governing equations

The mass conservation equations for the particle phase and fluid phase are written as:

\f[
\frac{\partial {\alpha}}{\partial {t}} + \frac{\partial{{\alpha}u^a_i}}{\partial{x_i}}=0, \tag{1}
\f]


\f[
\frac{\partial \beta}{\partial {t}} + \frac{\partial{\beta u^b_i}}{\partial{x_i}}=0, \tag{2}
\f]


where \f$\alpha\f$ and \f$\beta=1-\alpha\f$ are the particle and fluid volume concentrations, \f$u^a_i, u^b_i\f$ are the sediment and fluid phase velocities, and \f$i=1, 2, 3\f$ represents streamwise, spanwise and vertical component, respectively. The momentum equations for fluid and particle phases can be written as:


\anchor eq3 \f[
\frac{\partial {\rho^a}{\alpha}u^a_i}{\partial {t}} + \frac{\partial{{\rho^a}{\alpha}u^a_iu^a_j}}{\partial{x_j}}=-{\alpha}\frac{\partial{p}}{\partial{x_i}}+{\alpha}f_i-\frac{\partial{\tilde{p}^a}}{\partial{x_i}}+\frac{\partial{\tau^a_{ij}}}{\partial{x_j}} + {\alpha}{\rho^a}g_i  + {\alpha}f_i + {\alpha}{\beta}K(u^b_i-u^a_i)- S_{US} \ {\beta}K\nu_t^{b}\frac{\partial{\alpha}}{\partial{x_i}}, \tag{3}
\f]

\anchor eq4 \f[
\frac{\partial {\rho^b}{\beta}u^b_i}{\partial {t}} + \frac{\partial{{\rho^b}{\beta}u^b_iu^b_j}}{\partial{x_j}}=-\beta\frac{\partial{p}}{\partial{x_i}}+\beta f_i+\frac{\partial{\tau^b_{ij}}}{\partial{x_j}} + {\beta}{\rho^b}g_i +{\beta}f_i-{\alpha}{\beta}K(u^b_i-u^a_i)+ S_{US} \  {\beta}K{\nu_t^{b}}\frac{\partial{\alpha}}{\partial{x_i}}, \tag{4}
\f]

where \f$\rho^a, \rho^b\f$ are particle and fluid density, respectively, \f$g_i\f$ is the gravitational acceleration, \f$f_i\f$ is an external volume force and \f$p\f$ is the fluid pressure. \f$f_i\f$ is the external force that drives the flow. The fluid stress \f$\tau^b_{ij}\f$ includes fluid grain-scale (viscous) stress and fluid Reynolds stresses (see section \ref fluidstress) and  \f$\tilde{p}^a, \tau^a_{ij}\f$ are particle normal stress and shear stress (see section \ref particleStress). The last two terms on the right-hand-side (RHS) of e  \ref eq3  and \ref  eq4 are momentum coupling between the fluid phase and particle phase through drag force, where \f$K\f$ is the drag parameter. In particular the second to the last term represents averaged drag force due to mean relative velocity between fluid and particle phases, while the last term represents the fluid turbulent suspension term, also called drift velocity by Simonin (1991). This term is due to the correlation of sediment concentration and fluid velocity fluctuations and the gradient transport assumption is adopted here for its closure. Hence, \f$\nu_t^{b}\f$ is the turbulent viscosity to be calculated using a turbulence closure, and \f$S_{US} = 1/\sigma_c\f$ is the inverse of the the Schmidt number. This term is equivalent to the turbulent suspension flux of the Rouse profile in the two-phase flow formalism (see  Chauchat (2018) appendix 1 for a detailed demonstration). Other forces such as the lift force or the added mass force could play a role in sediment transport, according to Jha and Bombardelli (2010), the lift force in dilute suspended sediment transport only represent 4\% of the drag force and the added mass force can be of order of 10%  in the near bed region. 

The drag parameter \f$K\f$, is modeled following Schiller and Naumann (1933):

\f[
K=0.75 C_d \frac{\rho^b}{d_{eff}} \parallel \mathbf{u^b}-\mathbf{u^a}\parallel\beta^{-h_{Exp}} \tag{5}
\f]

where \f$d_{eff}= {\psi}d\f$ is the effective sediment diameter, in which \f$\psi\f$ is the shape factor and \f$d\f$ is the particle diameter. The hindrance function \f$\beta^{-h_{Exp}}\f$ represents the drag increase when the particle volume concentration increases. \f$h_{Exp}\f$ is the hindrance exponent that depends on the particulate Reynolds number (Di Felice (1994)). For simplicity, the value of \f$h_{Exp}\f$ is assumed to be constant (default value is 2.65), and its value can be specified from the *constant/transportProperties* file in SedFoam-3.2. This hypothesis is valid for particulate Reynolds numbers lower than unity or larger than 300, within this range the exponent value decreases down to \f$h_{Exp}\approx2\f$. The drag coefficient \f$C_d\f$ is calculated as:

\f[
C_d=\left\{
\begin{array}{r}
\frac{24}{Re_p}(1+0.15 Re_p^{0.687}), \quad \quad Re_p \leq 1000 \\
0.44, \quad  \quad Re_p>1000
\end{array},
\right. \tag{6}
\f]

in which, the particulate Reynolds number \f$Re_p\f$ is defined as: \f$Re_p=\beta\parallel\mathbf{u^b-u^a}\parallel d_{eff}/\nu^b\f$, where \f$\nu^b\f$ stands for the fluid kinematic viscosity. This drag model can be chosen by the keyword ``GidaspowSchillerNaumann'' in the file *constant/interfacialProperties* and it is especially well adapted for dealing with suspended particles. For situations in which the fluid flow inside the porous sediment bed has to be accurately solved, other drag models are available in SedFoam-3.2. The major issue in developing an Eulerian two-phase flow model is to provide closure laws for turbulence closures and granular stress models. This will be extensively discussed in the following subsections, particularly different modeling options available in SedFoam-3.2  are presented.

